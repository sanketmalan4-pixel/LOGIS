<!doctype html>
<html lang="en">
  <head>
    <script>
      if (!localStorage.getItem("token") || !localStorage.getItem("isLoggedIn")) {
        window.location.href = "login.html";
      }
    </script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>View Invoice | LogiSir</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>
        body { background: #f3f4f6; font-family: 'Inter', sans-serif; color: #111827; margin: 0; padding: 2rem; }
        .invoice-paper {
            background: white; width: 210mm; min-height: 297mm; margin: 0 auto; padding: 20mm;
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); position: relative;
        }
        .header { display: flex; justify-content: space-between; margin-bottom: 3rem; }
        .logo { font-size: 1.5rem; font-weight: 700; color: #4f46e5; display: flex; align-items: center; gap: 0.5rem; }
        .invoice-title { text-align: right; }
        .invoice-title h1 { margin: 0; font-size: 2.5rem; color: #e5e7eb; letter-spacing: 2px; text-transform: uppercase; }
        .invoice-meta { margin-top: 1rem; color: #6b7280; }
        
        .addresses { display: flex; justify-content: space-between; margin-bottom: 3rem; }
        .addr-box h3 { font-size: 0.9rem; color: #9ca3af; text-transform: uppercase; margin-bottom: 0.5rem; }
        .addr-box p { margin: 0.2rem 0; font-weight: 500; }
        
        .table-container { margin-bottom: 2rem; }
        table { width: 100%; border-collapse: collapse; }
        th { background: #4f46e5; color: white; padding: 0.8rem; text-align: left; font-size: 0.9rem; }
        td { padding: 0.8rem; border-bottom: 1px solid #e5e7eb; }
        
        .totals { display: flex; justify-content: flex-end; }
        .totals-table { width: 300px; }
        .totals-table td { border-bottom: none; padding: 0.4rem 0; text-align: right; }
        .totals-table .label { color: #6b7280; padding-right: 1rem; }
        .totals-table .amount { font-weight: 600; }
        .grand-total { font-size: 1.25rem; color: #4f46e5; border-top: 2px solid #e5e7eb; padding-top: 1rem !important; }
        
        .footer { position: absolute; bottom: 20mm; left: 20mm; right: 20mm; text-align: center; color: #9ca3af; font-size: 0.8rem; border-top: 1px solid #e5e7eb; padding-top: 1rem; }
        
        .actions { position: fixed; top: 2rem; right: 2rem; display: flex; flex-direction: column; gap: 1rem; }
        .btn { background: #111827; color: white; border: none; padding: 10px 15px; border-radius: 50%; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: transform 0.2s; }
        .btn:hover { transform: scale(1.1); background: #4f46e5; }
        
        @media print {
            body { background: white; padding: 0; }
            .invoice-paper { box-shadow: none; margin: 0; width: 100%; }
            .actions { display: none; }
        }
    </style>
  </head>
  <body>
    <!-- Floating Actions -->
    <div class="actions">
        <button class="btn" onclick="window.print()" title="Print"><i class="fa-solid fa-print"></i></button>
        <button class="btn" onclick="window.location.href='invoices.html'" title="Back"><i class="fa-solid fa-arrow-left"></i></button>
    </div>

    <div class="invoice-paper" id="invoiceContent">
        <div class="header">
            <div class="logo">
                <i class="fa-solid fa-truck-fast"></i>
                <span>LogiSir</span>
            </div>
            <div class="invoice-title">
                <h1>Invoice</h1>
                <div class="invoice-meta">
                    <p>#<span id="viewInvNumber">INV-000</span></p>
                    <p id="viewInvDate">Jan 01, 2024</p>
                </div>
            </div>
        </div>

        <div class="addresses">
            <div class="addr-box">
                <h3>From</h3>
                <p>LogiSir Logistics</p>
                <p>123 Business Park, Sector 5</p>
                <p>New Delhi, India 110001</p>
                <p>billing@LogiSir.com</p>
            </div>
            <div class="addr-box">
                <h3>Bill To</h3>
                <p id="viewClientName">Client Name</p>
                <p id="viewClientEmail">client@email.com</p>
                <p id="viewClientAddr">Client Address</p>
            </div>
        </div>

        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th style="border-radius: 4px 0 0 4px;">Item Description</th>
                        <th>Qty</th>
                        <th>Price</th>
                        <th style="border-radius: 0 4px 4px 0;">Total</th>
                    </tr>
                </thead>
                <tbody id="viewItemsBody">
                    <!-- Items go here -->
                </tbody>
            </table>
        </div>

        <div class="totals">
            <table class="totals-table">
                <tr>
                    <td class="label">Subtotal</td>
                    <td class="amount" id="viewSubtotal">₹0.00</td>
                </tr>
                <tr>
                    <td class="label">Tax (10%)</td>
                    <td class="amount" id="viewTax">₹0.00</td>
                </tr>
                <tr>
                    <td class="label grand-total">Total</td>
                    <td class="amount grand-total" id="viewTotal">₹0.00</td>
                </tr>
            </table>
        </div>

        <div class="footer">
            <p>Thank you for your business!</p>
            <p>Payment is due within 15 days. Please include invoice number on your check.</p>
        </div>
    </div>
    
    <script src="dashboard.js"></script>
    <script>
        // Simple logic to parse URL params and trigger render if needed immediately
        document.addEventListener("DOMContentLoaded", () => {
             const urlParams = new URLSearchParams(window.location.search);
             const invId = urlParams.get('id');
             if(invId && window.renderInvoiceView) {
                 // The render function in dashboard.js will handle this, 
                 // but we can call it explicitly if the routing there relies on pathname logic that might be complex.
                 // Ideally dashboard.js handles it.
             }
        });
    </script>
  </body>
</html>

